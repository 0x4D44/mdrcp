# Coverage Improvement Plan
**Date:** 2026-01-01
**Goal:** Increase code coverage to 98%.

## Strategy
We will iteratively add tests to `src/lib.rs` (unit tests) and `tests/integration.rs` (integration tests) to target the identified gaps. We will prioritize "low hanging fruit" (printing functions, helper methods) before moving to complex error simulation.

## Stage 1: High Impact - CLI & Output
Focus on `src/cli/mod.rs` and `src/lib.rs` output logic.

*   **Task 1.1:** Test `print_help`, `print_version_banner`, and `print_parse_error`.
    *   *Approach:* Add unit tests in `src/cli/mod.rs` that call these functions. While we can't easily assert stdout without a capturing harness, calling them ensures the code paths are executed.
*   **Task 1.2:** Test `ProjectType::label` and `BuildProfile::label` (if missing).
    *   *Approach:* Unit tests in `src/lib.rs`.
*   **Task 1.3:** Test JSON Summary Output.
    *   *Approach:* Add an integration test in `tests/integration.rs` that runs with `--summary json` and asserts the output structure.

## Stage 2: Manifest & Configuration Edge Cases
Focus on `manifest_bin_names` and parsing logic.

*   **Task 2.1:** Test explicit `[[bin]]` entries.
    *   *Approach:* Create a temporary test `Cargo.toml` with `[[bin]]` sections in `src/lib.rs` tests and verify `manifest_bin_names` extracts them correctly.
*   **Task 2.2:** Test Tauri "Detected" output.
    *   *Approach:* Integration test with a mock Tauri structure (src-tauri + tauri.conf.json) running in verbose mode.
*   **Task 2.3:** Test `parse_args` edge cases.
    *   *Approach:* Add unit tests in `src/cli/mod.rs` for empty values (`--target=`, `--summary=`) and the specific `text` summary format via flag.

## Stage 3: Error Conditions & Failures
Focus on hard-to-reach error paths.

*   **Task 3.1:** Simulate `fs::copy` failure.
    *   *Approach:* Attempt to deploy to a read-only directory or a directory where the user lacks permissions (if possible in the test environment) or use a path that is a file, not a directory.
*   **Task 3.2:** Test Member parsing failures.
    *   *Approach:* Create a workspace with a member that has an invalid `Cargo.toml` or is missing it, to hit the `continue` statements in `find_built_executables`.

## Execution
1.  Implement Stage 1 tasks.
2.  Run coverage.
3.  Implement Stage 2 tasks.
4.  Run coverage.
5.  Implement Stage 3 tasks.
6.  Final verification.
